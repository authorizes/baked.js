<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Your prismic.io singlepage project</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="prismic-routing-param" content="id">
    <meta property="og:url" content="[%= urlToHere() %]" />

    <script src="https://prismicio.github.io/baked.js/baked-0.3.0.js"></script>
  </head>
  <body>

    <script type="text/prismic-query" data-binding="product" data-single="true">
      [
        [:d = any(document.id, ["$id"])]
      ]
    </script>

    <script type="text/prismic-query-js" data-binding="*">
      // stupid query which retrieves all document with the same type
      if (!product)
        return {sameTypes: emptyResponse()};
      return form()
        .query(Prismic.Predicates.at("document.type", product.type))
        .submit()
        .then(withName("sameTypes"));
    </script>

    <h1>[%= product.getText('product.name') %]</h1>

    <div>[%= sameTypes.total_results_size %] document(s) of this type (“[%= product.type %]”)</div>

    <div>
      <img data-src="[%= product.getImageView('product.image', 'icon').url %]">
    </div>

    [%- partial('/footer') %]

  </body>
</html>
